---
weight: 4
title: "NASを完全に理解する"
date: 2025-03-16T00:00:00+09:00
lastmod: 2025-03-16T00:00:00+09:00
draft: true
author: "しぶや"
authorLink: "https://github.com/shibuya-s-eg"
description: "NASを完全に理解する。"
images: []
resources:
- name: "featured-image"
  src: "featured-image.png"

tags: ["Database, Storage"]
categories: ["Database, Storage"]

lightgallery: true
---

レポートとかしてる、winもあり、dbのパスの中身、設定ファイルの内容、オンアクセススキャン、デーモン、メールフイルタリング、dbスキャンの内容

検知方式	メリット	デメリット
ハッシュベース	高速・誤検知が少ない	変異したマルウェアに弱い
シグネチャベース	既知のパターンに強い	ゼロデイ攻撃には無力
ヒューリスティック分析	未知のマルウェアも検知可能	誤検知が発生しやすい
YARA ルール	カスタムルールで柔軟な検知	手動でルールを作る必要がある
PE解析	EXE/DLLの異常検知	高度な難読化には対応が難しい
圧縮ファイル解析	アーカイブ内のマルウェアも検出可能	多層圧縮には対応が不完全な場合がある

比較項目	静的ヒューリスティック解析	動的解析（サンドボックス）
実際にプログラムを実行するか	しない	する
コードのパターン分析	可能	可能
メタデータやヘッダーの解析	可能	ほぼしない
難読化されたマルウェアの検知	限定的に可能	実行後に解析するため容易
API の呼び出し監視	コードを見て推測	実際の動作を監視
実行時のファイル・レジストリ変更	わからない	監視可能


こんにちは、しぶやです。\
最近、Synologyのnasを中古で安く仕入れたので、これを機にNASを「完全に理解」していきたいと思います。

## TL;DR

* NASはファイルサーバみたいなもの。
* 標準機能として、RAIDが組めたり、バックアップとれたり、いろいろできる。
* NAS用ソフトが充実している。

## 1　NASの基本

本章では、NASの基本について学んでいきます。

### 1.1　NASとは

NASとは、Network Attached Strorageの略です。その名の通り、ネットワークに接続して利用するストレージです。\
代表的なNASメーカーには以下のようなものがあります。

* Synology
* QNAP
* BUFFALO
* NETGEAR

何はともあれ、現物を見てイメージの具体化をしてみます。

　
* [Synology DiskStation DS223j](https://www.synology.com/ja-jp/products/DS223j)\
小型で静音の省エネ型ストレージ

こちらは、家庭用でも利用されているNASです。Youtubeとかもよく見るサイズのものですね。

　
* [Synology DiskStation DS3622xs+](https://www.synology.com/ja-jp/products/DS3622xs+)\
どんな環境にも適合する、パワフルで大容量のストレージ

こちらは、より高性能な大容量ストレージです。いかつい見た目でかっこよいですね:(fa-brands fa-linux fax):

　
* [Synology FlashStation FS6400](http://synology.com/ja-jp/products/FS6400)\
I/O インテンシブなアプリケーション向けの超高速オールフラッシュサーバー

ラックマウント用のNASもあるようです。

　
* [Synology Plusシリーズ3.5インチSATA HDD](https://www.synology.com/ja-jp/products/drives/hdd/plus-hat)\
家庭やスモールオフィス環境のSynologyシステム専用に作られた高信頼性ハードドライブ
* [Synology Enterpriseシリーズ2.5インチSATA SSD](https://www.synology.com/ja-jp/products/drives/ssd/enterprise-sat)\
SynologyのSSDを使用してストレージ インフラを最新化

NASには上記のようなHDDやSDDを差し込み利用します。**nベイ**というのは、これらを差し込むスロットが何個あるかを表しています。


### 1.2　NASの機能

それでは、NASの具体的な機能を見ていきます。

* **ファイル共有**\
ネットワーク経由でファイルの読み書きが可能です。「具体的に中で何が動いているのか」についてですが、NASはSMBやNFSなど複数のプロトコルをサポートしており、中身は一般的なOSSでファイルサーバのように動くようです。

* **アクセス管理**\
利用者視点ではもちろん機能ですね。ユーザごとに読み取り専用などアクセス権の管理が可能です。

* **RAID**\
RAIDによるデータの冗長性を確保できます。もちろん複数ベイが必要になります。

{{< admonition note "復習：RAID" >}}
RAIDはRedundant Arrays of Inexpensive Disksの略です。複数のディスクを組み合わせて冗長化するやつですね。\
RAIDの主なレベルは以下です。
* **RAID 0**\
冗長化していない通常のモードです。
信頼性は失われますが、書き込む量も増えないため、高速でストレージの利用効率も高いです。

* **RAID 1**\
2台のディスクを利用したシンプルなミラーリングです。データを二重に保存します。

* **RAID 5**\
3台以上のディスクを利用し、データとそのパリティをそれぞれ分散させて保存します。
パリティを保存しているため、容量効率は高いですが、データの復旧には時間がかかってしまいます。

* **RAID 6**\
RAID5 + パリティです。RAID1やRIAD5と異なり、2台のディスクが壊れても復旧が可能です。

* **RAID 10**\
RAID 1 + RAID 0でRAID 10です。RAID 5/6よりも書き込みが高速で、耐障害性も高いです。

{{< /admonition >}}

* **バックアップ**\
バックアップにはPC等のクライアントのバックアップとNAS自身のデータのバックアップの2つ観点があります。
前者は専用のクライアントソフトなどを利用することで、手軽に頻度や対象を指定したバックアップを行えます。
後者は、Google DriveやAWSなど、クラウドストレージへNAS自身のデータをバックアップできます。

{{< admonition tip >}}
NASは標準でRAID機能を持っているものが多いですが、これはあくまで冗長化です。\
操作ミスによるNASデータの削除やランサムウェアによる被害が発生した際はデータを失ってしまいます。\
これらの対策として別のストレージにバックアップを取ることが重要となり、NASは標準でクラウドストレージへのバップアップを行うことができます。
{{< /admonition >}}


* **リモートアクセスやVPN**\
専用ソフトを利用することで、インターネット経由で安全にアクセスできる機能を備えています。
インターネット経由で利用することも考えると当たり前に欲しい機能ですね。

* **VMやコンテナの実行**\
高性能のNASの場合は、VMやコンテナを中で動かせるようです。
独自のアプリケーションを中で動かすことで様々なことができるようになります。

* **セキュリティ**\
NAS自身がファイアウォール機能などを持っていることもあります。
また、高性能なものは2段階認証を利用できたり、ウイルススキャン機能を持っていたりします。

* **Webサーバやメディアサーバ**\
サーバ機能を持っているものもあるようです。

### 1.3　NASのメリット・デメリット

NASのメリットは何と言っても1.2であげたものが**手軽に利用できる**ことです。
外付けHDDだけでは、複数人でデータを共有することはできないですし、ネットワーク経由でデータにアクセスすることもできません。


一方でNASのデメリットは、初期費用が高いことです。高機能なものにもなると、HDD抜きでNAS自身が非常に高いです。

{{< admonition note "所感" >}}
上記で太字で記載しましたが、**NASの本質は標準で様々な機能が入っており、手軽に導入できる**ことかと思います。
NAS自身のOSは専用の組み込みOSであることが多いようですが、その気になればPC1台とRAIDに必要な外付けHDDがあれば1.2で上げた機能をすべて実現できると思います。
これらの導入コストを低くできることがNASのメリットだと考えています。※ 静音だとか性能だとかって話はあると思いますが。
{{< /admonition >}}

### 1.4　外付けストレージ・ファイルサーバとの違い

比較表を書こうと思いましたが、1.3で述べたように、以下のような関係で表すことが適切かと思いました。

* **外付けHDD ⊂ ファイルサーバ ⊂ NAS**

外付けHDDもRAIDが組めるものがありますし、複数台で自分で組むこともできるでしょう。
また、外付けHDDをマウントし、ファイルサーバを建てることもできれば、フアイルサーバに機能を加えNASっぽく運用することもできるでしょう。
これらのことから、それぞれの境界はやや曖昧で、包含関係がしっくりきました。

### 1.5　ユースケース

* **ファイルサーバ**\
家庭用、企業用問わずファイルサーバとしてデータ共有に利用されています。

* **バックアップ**\
バックアップの保存用途でNASが利用されています。

* **その他**\
メディアサーバ等様々な用途で利用されています。IoTの発展に伴い、カメラデータの保存等にも使われているようです。

{{< admonition tip >}}
NASというよりHDDの話です。
よく壊れやすいと言われているHDDについてですが、動かし続けていないとより壊れやすいようです。
具体的な理由はChatGPTが以下のように教えてくれました。
* ヘッドの位置ずれ
* 潤滑油の劣化
* 温度管理の不良
* 結露の問題
* 機械部品の劣化
家とかも誰も住んでいないとすぐだめになったりしますよね:(fa-brands fa-linux fax):
{{< /admonition >}}

## 2　Synologyを触る

## 3　まとめ

読み書き速度

## 参考

[1] [Synology](https://www.synology.com/)
[2] [hon]()


